var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,n){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=n(e,!0):"function"==typeof define&&define.amd?define(function(){return n(e,!0)}):n(e)}("undefined"!=typeof window?window:void 0,function(d,l){"use strict";var h,p,f,g,b,m,y,v,x,E,w,C,N,T,S,L,z,k,I,M,R,j,A,i=d.document,H=i.documentElement,P=i.body,O="3.3.0",a=function e(n,t){return new e.fn.init(n,t)},r=(a.version=O,a.fn=a.prototype={version:O,constructor:a,context:P,condition:H,routine:["initCond","renderElem","renderJiya","renderHanging","correctBiaodian","renderHWS","substCombLigaWithPUA"],init:function(){return arguments[0]&&(this.context=arguments[0]),arguments[1]&&(this.condition=arguments[1]),this},setRoutine:function(e){return Array.isArray(e)&&(this.routine=e),this},render:function(e){var n=this;return(e=Array.isArray(e)?e:this.routine).forEach(function(e){"string"==typeof e&&"function"==typeof n[e]?n[e]():Array.isArray(e)&&"function"==typeof n[e[0]]&&n[e.shift()].apply(n,e)}),this}},a.fn.init.prototype=a.fn,a.init=function(){return a.init=a().render()},{punct:{base:"[…,.;:!?‽_]",sing:"[‐-—…]",middle:"[\\/~\\-&‐-—_]",open:"['\"‘“\\(\\[¡¿⸘«‹‚“„]",close:"['\"”’\\)\\]»›‛”‟]",end:"['\"”’\\)\\]»›‛”‟‼‽⁇-⁉,.;:!?]"},biaodian:{base:"[︰．、，。：；？！ー]",liga:"[—…⋯]",middle:"[·＼／－゠＆・＿]",open:"[「『《〈（〔［｛【〖]",close:"[」』》〉）〕］｝】〗]",end:"[」』》〉）〕］｝】〗︰．、，。：；？！ー]"},hanzi:{base:"[一-鿿㐀-䶵㇀-㇣〇﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[�-�][�-�]",desc:"[⿰-⿺]",radical:"[⼀-⿕⺀-⻳]"},latin:{base:"[A-Za-z0-9À-ÿĀ-ſƀ-ɏⱠ-Ɀ꜠-ꟿḀ-ỿ]",combine:"[̀-́᷀-᷿]"},ellinika:{base:"[0-9Ͱ-Ͽἀ-῿]",combine:"[̀-᷀ͅ-᷿]"},kirillica:{base:"[0-9Ѐ-҂Ҋ-ӿԀ-ԯꙀ-ꙮ꙾-ꚗ]",combine:"[҃-҉ⷠ-ⷿ꙯-꙽ꚟ]"},kana:{base:"[アイウエオ-ヺあいうえお-ゔゟヿ]|�[�-�]",small:"[ぁぃぅぇぉァィゥェォっゃゅょゎゕゖッャュョヮヵヶㇰ-ㇿ]",combine:"[゙-゜]",half:"[ｦ-ﾟ]",mark:"[゠ゝゞ・-ヾ]"},eonmun:{base:"[가-힣]",letter:"[ᄀ-ᇿㅏ-ㅣㄱ-ㆎꥠ-ꥼힰ-ퟻ]",half:"[ﾡ-ￜ]"},zhuyin:{base:"[ㄅ-ㄭㆠ-ㆺ]",initial:"[ㄅ-ㄙㄪ-ㄬㆠ-ㆣ]",medial:"[ㄧ-ㄩ]",final:"[ㄚ-ㄩㄭㆤ-ㆳㆸ-ㆺ]",tone:"[˙ˊ˅ˇˋ˪˫]",checked:"[ㆴ-ㆷ][̍͘]?"}}),o=(O="[\\x20\\t\\r\\n\\f]",h=r.punct.open,r.punct.close,p=r.punct.end,f=r.punct.middle,B=r.punct.sing,f=h+"|"+p+"|"+f,g=r.biaodian.open,q=r.biaodian.close,b=r.biaodian.end,m=r.biaodian.middle,n=r.biaodian.liga+"{2}",e=g+"|"+b+"|"+m,y=r.kana.base+r.kana.combine+"?",v=r.kana.small+r.kana.combine+"?",x=r.kana.half,E=r.eonmun.base+"|"+r.eonmun.letter,w=r.eonmun.half,C=r.hanzi.base+"|"+r.hanzi.desc+"|"+r.hanzi.radical+"|"+y,N=r.ellinika.combine,t=r.latin.base+N+"*",N=r.ellinika.base+N+"*",T=r.kirillica.combine,T=r.kirillica.base+T+"*",L=C+"|(?:"+(S=t+"|"+N+"|"+T)+"|['’])+",z=r.zhuyin.initial,k=r.zhuyin.medial,I=r.zhuyin.final,M=r.zhuyin.tone+"|"+r.zhuyin.checked,{char:{punct:{all:new RegExp("("+f+")","g"),open:new RegExp("("+h+")","g"),end:new RegExp("("+p+")","g"),sing:new RegExp("("+B+")","g")},biaodian:{all:new RegExp("("+e+")","g"),open:new RegExp("("+g+")","g"),close:new RegExp("("+q+")","g"),end:new RegExp("("+b+")","g"),liga:new RegExp("("+n+")","g")},hanzi:new RegExp("("+C+")","g"),latin:new RegExp("("+t+")","ig"),ellinika:new RegExp("("+N+")","ig"),kirillica:new RegExp("("+T+")","ig"),kana:new RegExp("("+y+"|"+v+"|"+x+")","g"),eonmun:new RegExp("("+E+"|"+w+")","g")},group:{biaodian:[new RegExp("(("+e+"){2,})","g"),new RegExp("("+n+g+")","g")],punct:null,hanzi:new RegExp("("+C+")+","g"),western:new RegExp("("+t+"|"+N+"|"+T+"|"+f+")+","ig"),kana:new RegExp("("+y+"|"+v+"|"+x+")+","g"),eonmun:new RegExp("("+E+"|"+w+"|"+f+")+","g")},jinze:{hanging:new RegExp(O+"*([、，。．])(?!"+b+")","ig"),touwei:new RegExp("("+g+"+)("+L+")("+b+"+)","ig"),tou:new RegExp("("+g+"+)("+L+")","ig"),wei:new RegExp("("+L+")("+b+"+)","ig"),middle:new RegExp("("+L+")("+m+")("+L+")","ig")},zhuyin:{form:new RegExp("^˙?("+z+")?("+k+")?("+I+")?("+M+")?$"),diao:new RegExp("("+M+")","g")},hws:{base:[new RegExp("("+C+")("+S+"|"+h+")","ig"),new RegExp("("+S+"|"+p+")("+C+")","ig")],strict:[new RegExp("("+C+")"+O+"?("+S+"|"+h+")","ig"),new RegExp("("+S+"|"+p+")"+O+"?("+C+")","ig")]},"display-as":{"ja-font-for-hant":["查 査","啟 啓","鄉 鄕","值 値","污 汚"],"comb-liga-pua":[["a[̍͘]","󰁡"],["e[̍͘]","󰁥"],["i[̍͘]","󰁩"],["o[̍͘]","󰁯"],["u[̍͘]","󰁵"],["ㆴ[̍͘]","󳆴"],["ㆵ[̍͘]","󳆵"],["ㆶ[̍͘]","󳆶"],["ㆷ[̍͘]","󳆷"]],"comb-liga-vowel":[["a[̍͘]","󰁡"],["e[̍͘]","󰁥"],["i[̍͘]","󰁩"],["o[̍͘]","󰁯"],["u[̍͘]","󰁵"]],"comb-liga-zhuyin":[["ㆴ[̍͘]","󳆴"],["ㆵ[̍͘]","󳆵"],["ㆶ[̍͘]","󳆶"],["ㆷ[̍͘]","󳆷"]]},"inaccurate-char":[["[•‧]","·"],["⋯⋯","……"],["──","——"],["‵","‘"],["′","’"],["‶","“"],["″","”"]]}),u=(a.UNICODE=r,a.TYPESET=o,a.UNICODE.cjk=a.UNICODE.hanzi,a.UNICODE.greek=a.UNICODE.ellinika,a.UNICODE.cyrillic=a.UNICODE.kirillica,a.UNICODE.hangul=a.UNICODE.eonmun,a.UNICODE.zhuyin.ruyun=a.UNICODE.zhuyin.checked,a.TYPESET.char.cjk=a.TYPESET.char.hanzi,a.TYPESET.char.greek=a.TYPESET.char.ellinika,a.TYPESET.char.cyrillic=a.TYPESET.char.kirillica,a.TYPESET.char.hangul=a.TYPESET.char.eonmun,a.TYPESET.group.hangul=a.TYPESET.group.eonmun,a.TYPESET.group.cjk=a.TYPESET.group.hanzi,{id:function(e,n){return(n||i).getElementById(e)},tag:function(e,n){return this.makeArray((n||i).getElementsByTagName(e))},qs:function(e,n){return(n||i).querySelector(e)},qsa:function(e,n){return this.makeArray((n||i).querySelectorAll(e))},parent:function(e,n){if(!n)return e?e.parentNode:void 0;if("function"==typeof u.matches){for(;!u.matches(e,n);){if(!e||e===i.documentElement){e=void 0;break}e=e.parentNode}return e}},create:function(e,n){e="!"===e?i.createDocumentFragment():""===e?i.createTextNode(n||""):i.createElement(e);try{n&&(e.className=n)}catch(e){}return e},clone:function(e,n){return e.cloneNode("boolean"!=typeof n||n)},remove:function(e){return e.parentNode.removeChild(e)},setAttr:function(e,n){if("object"===(void 0===n?"undefined":_typeof(n))){var t=n.length;if("object"===_typeof(n[0])&&"name"in n[0])for(var i=0;i<t;i++)void 0!==n[i].value&&e.setAttribute(n[i].name,n[i].value);else for(var r in n)n.hasOwnProperty(r)&&void 0!==n[r]&&e.setAttribute(r,n[r]);return e}},isElmt:function(e){return e&&e.nodeType===Node.ELEMENT_NODE},isIgnorable:function(e){return!!e&&("WBR"===e.nodeName||e.nodeType===Node.COMMENT_NODE)},makeArray:function(e){return Array.prototype.slice.call(e)},extend:function(e,n){if(("object"===(void 0===e?"undefined":_typeof(e))||"function"==typeof e)&&"object"===(void 0===n?"undefined":_typeof(n)))for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}}),B=function(i){var t=i.NON_INLINE_PROSE,r=i.PRESETS.prose.filterElements,a=(d||{}).document||void 0;function o(e,n,t){var i=Element.prototype,i=i.matches||i.mozMatchesSelector||i.msMatchesSelector||i.webkitMatchesSelector;return e instanceof Element?i.call(e,n):!(!t||!/^[39]$/.test(e.nodeType))}if(void 0===a)throw new Error("Fibre requires a DOM-supported environment.");function c(e,n){return new c.fn.init(e,n)}return c.version="0.2.1",c.matches=o,(c.fn=c.prototype={constructor:c,version:"0.2.1",finder:[],context:void 0,portionMode:"retain",selector:{},preset:"prose",init:function(e,n){if(n&&(this.preset=null),this.selector={context:null,filter:[],avoid:[],boundary:[]},!e)throw new Error("A context is required for Fibre to initialise.");return e instanceof Node?e instanceof Document?this.context=e.body||e:this.context=e:"string"==typeof e&&(this.context=a.querySelector(e),this.selector.context=e),this},filterFn:function(e){var n=this.selector.filter.join(", ")||"*",t=this.selector.avoid.join(", ")||null,n=o(e,n,!0)&&!o(e,t);return("prose"!==this.preset||r(e))&&n},boundaryFn:function(e){var n=o(e,this.selector.boundary.join(", ")||null);return"prose"===this.preset&&t(e)||n},filter:function(e){return"string"==typeof e&&this.selector.filter.push(e),this},endFilter:function(e){return e?this.selector.filter=[]:this.selector.filter.pop(),this},avoid:function(e){return"string"==typeof e&&this.selector.avoid.push(e),this},endAvoid:function(e){return e?this.selector.avoid=[]:this.selector.avoid.pop(),this},addBoundary:function(e){return"string"==typeof e&&this.selector.boundary.push(e),this},removeBoundary:function(){return this.selector.boundary=[],this},setMode:function(e){return this.portionMode="first"===e?"first":"retain",this},replace:function(e,n){var t=this;return t.finder.push(i(t.context,{find:e,replace:n,filterElements:function(e){return t.filterFn(e)},forceContext:function(e){return t.boundaryFn(e)},portionMode:t.portionMode})),t},wrap:function(e,n){var t=this;return t.finder.push(i(t.context,{find:e,wrap:n,filterElements:function(e){return t.filterFn(e)},forceContext:function(e){return t.boundaryFn(e)},portionMode:t.portionMode})),t},revert:function(e){var n=this.finder.length,e=Number(e)||(0===e?Number(0):"all"===e?n:1);if(void 0===n||0===n)return this;for(var t=e=n<e?n:e;0<t;t--)this.finder.pop().revert();return this}}).filterOut=c.fn.avoid,c.fn.init.prototype=c.fn,c}((R="retain",j=i,A={}.hasOwnProperty,D.NON_PROSE_ELEMENTS={br:1,hr:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1},D.NON_CONTIGUOUS_PROSE_ELEMENTS={address:1,article:1,aside:1,blockquote:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,ul:1,br:1,li:1,summary:1,dt:1,details:1,rp:1,rt:1,rtc:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1,table:1,tbody:1,thead:1,th:1,tr:1,td:1,caption:1,col:1,tfoot:1,colgroup:1},D.PRESETS={prose:{forceContext:D.NON_INLINE_PROSE=function(e){return A.call(D.NON_CONTIGUOUS_PROSE_ELEMENTS,e.nodeName.toLowerCase())},filterElements:function(e){return!A.call(D.NON_PROSE_ELEMENTS,e.nodeName.toLowerCase())}}},(D.Finder=_).prototype={search:function(){var a,o=0,c=0,s=this.options.find,e=this.getAggregateText(),d=[],u=this;return s="string"==typeof s?RegExp(String(s).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1"),"g"):s,function e(n){for(var t=0,i=n.length;t<i;++t){var r=n[t];if("string"==typeof r){if(s.global)for(;a=s.exec(r);)d.push(u.prepMatch(a,o++,c));else(a=r.match(s))&&d.push(u.prepMatch(a,0,c));c+=r.length}else e(r)}}(e),d},prepMatch:function(e,n,t){if(!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return e.endIndex=t+e.index+e[0].length,e.startIndex=t+e.index,e.index=n,e},getAggregateText:function(){var a=this.options.filterElements,o=this.options.forceContext;return function e(n,t){if(3===n.nodeType)return[n.data];if(a&&!a(n))return[];t=[""];var i=0;if(n=n.firstChild)do{var r;3!==n.nodeType?(r=e(n),o&&1===n.nodeType&&(!0===o||o(n))?(t[++i]=r,t[++i]=""):("string"==typeof r[0]&&(t[i]+=r.shift()),r.length&&(t[++i]=r,t[++i]=""))):t[i]+=n.data}while(n=n.nextSibling);return t}(this.node)},processMatches:function(){var e,n,t,i=this.matches,r=this.node,u=this.options.filterElements,a=[],o=r,c=i.shift(),s=0,d=0,l=[r];e:for(;;){if(3===o.nodeType&&(!n&&o.length+s>=c.endIndex?n={node:o,index:d++,text:o.data.substring(c.startIndex-s,c.endIndex-s),indexInMatch:s-c.startIndex,indexInNode:c.startIndex-s,endIndexInNode:c.endIndex-s,isEnd:!0}:e&&a.push({node:o,index:d++,text:o.data,indexInMatch:s-c.startIndex,indexInNode:0}),!e&&o.length+s>c.startIndex&&(e={node:o,index:d++,indexInMatch:0,indexInNode:c.startIndex-s,endIndexInNode:c.endIndex-s,text:o.data.substring(c.startIndex-s,c.endIndex-s)}),s+=o.data.length),t=1===o.nodeType&&u&&!u(o),e&&n){if(o=this.replaceMatch(c,e,a,n),s-=n.node.data.length-n.endIndexInNode,n=e=null,a=[],d=0,!(c=i.shift()))break}else if(!t&&(o.firstChild||o.nextSibling)){o=o.firstChild?(l.push(o),o.firstChild):o.nextSibling;continue}for(;;){if(o.nextSibling){o=o.nextSibling;break}if((o=l.pop())===r)break e}}},revert:function(){for(var e=this.reverts.length;e--;)this.reverts[e]();this.reverts=[]},prepareReplacementString:function(e,n,i,t){var r=this.options.portionMode;return"first"===r&&0<n.indexInMatch?"":(e=e.replace(/\$(\d+|&|`|')/g,function(e,n){var t;switch(n){case"&":t=i[0];break;case"`":t=i.input.substring(0,i.startIndex);break;case"'":t=i.input.substring(i.endIndex);break;default:t=i[+n]}return t}),"first"===r?e:n.isEnd?e.substring(n.indexInMatch):e.substring(n.indexInMatch,n.indexInMatch+n.text.length))},getPortionReplacementNode:function(e,n,t){var i=this.options.replace||"$&",r=this.options.wrap;if(r&&r.nodeType&&((a=j.createElement("div")).innerHTML=r.outerHTML||(new XMLSerializer).serializeToString(r),r=a.firstChild),"function"==typeof i)return(i=i(e,n,t))&&i.nodeType?i:j.createTextNode(String(i));var a="string"==typeof r?j.createElement(r):r;return(i=j.createTextNode(this.prepareReplacementString(i,e,n,t))).data&&a?(a.appendChild(i),a):i},replaceMatch:function(e,n,u,t){var i,r,a=n.node,o=t.node;if(a===o)return i=a,0<n.indexInNode&&(c=j.createTextNode(i.data.substring(0,n.indexInNode)),i.parentNode.insertBefore(c,i)),r=this.getPortionReplacementNode(t,e),i.parentNode.insertBefore(r,i),t.endIndexInNode<i.length&&(s=j.createTextNode(i.data.substring(t.endIndexInNode)),i.parentNode.insertBefore(s,i)),i.parentNode.removeChild(i),this.reverts.push(function(){c===r.previousSibling&&c.parentNode.removeChild(c),s===r.nextSibling&&s.parentNode.removeChild(s),r.parentNode.replaceChild(i,r)}),r;for(var c=j.createTextNode(a.data.substring(0,n.indexInNode)),s=j.createTextNode(o.data.substring(t.endIndexInNode)),l=this.getPortionReplacementNode(n,e),h=[],p=0,f=u.length;p<f;++p){var d=u[p],g=this.getPortionReplacementNode(d,e);d.node.parentNode.replaceChild(g,d.node),this.reverts.push(function(e,n){return function(){n.parentNode.replaceChild(e.node,n)}}(d,g)),h.push(g)}var b=this.getPortionReplacementNode(t,e);return a.parentNode.insertBefore(c,a),a.parentNode.insertBefore(l,a),a.parentNode.removeChild(a),o.parentNode.insertBefore(b,o),o.parentNode.insertBefore(s,o),o.parentNode.removeChild(o),this.reverts.push(function(){c.parentNode.removeChild(c),l.parentNode.replaceChild(a,l),s.parentNode.removeChild(s),b.parentNode.replaceChild(o,b)}),b}},D));function D(){return function(e,n,t,i,r){if(n&&!n.nodeType&&arguments.length<=2)return!1;var a="function"==typeof t;a&&(t=function(t){return function(e,n){return t(e.text,n.startIndex)}}(t));var o=F(n,{find:e,wrap:a?null:t,replace:a?t:"$"+(i||"&"),prepMatch:function(e,n){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var t;return 0<i&&(t=e[i],e.index+=e[0].indexOf(t),e[0]=t),e.endIndex=e.index+e[0].length,e.startIndex=e.index,e.index=n,e},filterElements:r});return D.revert=function(){return o.revert()},!0}.apply(null,arguments)||F.apply(null,arguments)}function F(e,n){return new _(e,n)}function _(e,n){var t=n.preset&&D.PRESETS[n.preset];if(n.portionMode=n.portionMode||R,t)for(var i in t)A.call(t,i)&&!A.call(n,i)&&(n[i]=t[i]);this.node=e,this.options=n,this.prepMatch=n.prepMatch||this.prepMatch,this.reverts=[],this.matches=this.search(),this.matches.length&&this.processMatches()}(q=u.create("div")).appendChild(u.create("","0-")),q.appendChild(u.create("","2")),q.normalize();var q,U=2!==q.firstChild.length;function Y(e){return"function"==typeof e||e instanceof Element?e:void 0}function W(e){var n=0===e.index&&e.isEnd?"biaodian cjk":"biaodian cjk portion "+(0===e.index?"is-first":e.isEnd?"is-end":"is-inner"),n=u.create("h-char-group",n);return n.innerHTML=e.text,n}function V(e){var n=u.create("div"),t=e.charCodeAt(0).toString(16);return n.innerHTML='<h-char unicode="'+t+'" class="biaodian cjk '+((t=e).match(o.char.biaodian.open)?"bd-open":t.match(o.char.biaodian.close)?"bd-close bd-end":t.match(o.char.biaodian.end)?/(?:\u3001|\u3002|\uff0c)/i.test(t)?"bd-end bd-cop":"bd-end":t.match(new RegExp(r.biaodian.liga))?"bd-liga":t.match(new RegExp(r.biaodian.middle))?"bd-middle":"")+'">'+e+"</h-char>",n.firstChild}u.extend(B.fn,{normalize:function(){return U&&this.context.normalize(),this},jinzify:function(e){return this.filter(e||null).avoid("h-jinze").replace(o.jinze.touwei,function(e,n){var t=u.create("h-jinze","touwei");return t.innerHTML=n[0],0===e.index&&e.isEnd||1===e.index?t:""}).replace(o.jinze.wei,function(e,n){var t=u.create("h-jinze","wei");return t.innerHTML=n[0],0===e.index?t:""}).replace(o.jinze.tou,function(e,n){var t=u.create("h-jinze","tou");return t.innerHTML=n[0],0===e.index&&e.isEnd||1===e.index?t:""}).replace(o.jinze.middle,function(e,n){var t=u.create("h-jinze","middle");return t.innerHTML=n[0],0===e.index&&e.isEnd||1===e.index?t:""}).endAvoid().endFilter()},groupify:function(e){e=u.extend({biaodian:!1,hanzi:!1,kana:!1,eonmun:!1,western:!1},e||{});return this.avoid("h-word, h-char-group"),e.biaodian&&this.replace(o.group.biaodian[0],W).replace(o.group.biaodian[1],W),(e.hanzi||e.cjk)&&this.wrap(o.group.hanzi,u.clone(u.create("h-char-group","hanzi cjk"))),e.western&&this.wrap(o.group.western,u.clone(u.create("h-word","western"))),e.kana&&this.wrap(o.group.kana,u.clone(u.create("h-char-group","kana"))),(e.eonmun||e.hangul)&&this.wrap(o.group.eonmun,u.clone(u.create("h-word","eonmun hangul"))),this.endAvoid(),this},charify:function(e){return(e=u.extend({avoid:!0,biaodian:!1,punct:!1,hanzi:!1,latin:!1,ellinika:!1,kirillica:!1,kana:!1,eonmun:!1},e||{})).avoid&&this.avoid("h-char"),e.biaodian&&this.replace(o.char.biaodian.all,Y(e.biaodian)||function(e){return V(e.text)}).replace(o.char.biaodian.liga,Y(e.biaodian)||function(e){return V(e.text)}),(e.hanzi||e.cjk)&&this.wrap(o.char.hanzi,Y(e.hanzi||e.cjk)||u.clone(u.create("h-char","hanzi cjk"))),e.punct&&this.wrap(o.char.punct.all,Y(e.punct)||u.clone(u.create("h-char","punct"))),e.latin&&this.wrap(o.char.latin,Y(e.latin)||u.clone(u.create("h-char","alphabet latin"))),(e.ellinika||e.greek)&&this.wrap(o.char.ellinika,Y(e.ellinika||e.greek)||u.clone(u.create("h-char","alphabet ellinika greek"))),(e.kirillica||e.cyrillic)&&this.wrap(o.char.kirillica,Y(e.kirillica||e.cyrillic)||u.clone(u.create("h-char","alphabet kirillica cyrillic"))),e.kana&&this.wrap(o.char.kana,Y(e.kana)||u.clone(u.create("h-char","kana"))),(e.eonmun||e.hangul)&&this.wrap(o.char.eonmun,Y(e.eonmun||e.hangul)||u.clone(u.create("h-char","eonmun hangul"))),this.endAvoid(),this}}),u.extend(a,{isNodeNormalizeNormal:U,find:B,createBDGroup:W,createBDChar:V}),u.matches=a.find.matches,["setMode","wrap","replace","revert","addBoundary","removeBoundary","avoid","endAvoid","filter","endFilter","jinzify","groupify","charify"].forEach(function(e){a.fn[e]=function(){return this.finder||(this.finder=a.find(this.context)),this.finder[e](arguments[0],arguments[1]),this}});var Z,e,n,t,$,J,G,c={};function K(e,n){var t,i=u.create("canvas");return i.width="50",i.height="20",i.style.display="none",P.appendChild(i),(t=i.getContext("2d")).textBaseline="top",t.font="15px "+n+", sans-serif",t.fillStyle="black",t.strokeStyle="black",t.fillText(e,0,0),{node:i,context:t,remove:function(){u.remove(i,P)}}}function Q(e,n){var t,i=e.context,r=n.context;try{for(var a=1;a<=20;a++)for(var o=1;o<=50;o++){if(void 0===t&&i.getImageData(o,a,1,1).data[3]!==r.getImageData(o,a,1,1).data[3]){t=!1;break}if("boolean"==typeof t)break;50===o&&20===a&&void 0===t&&(t=!0)}return e.remove(),n.remove(),n=e=null,t}catch(e){}return!1}function X(e){var n,t=e.charAt(0).toUpperCase()+e.slice(1);return(e+" "+J.join(t+" ")+t).split(" ").forEach(function(e){"string"==typeof G.style[e]&&(n=!0)}),n||!1}function ee(e,n){var t,i=P||u.create("body"),r=u.create("div"),a=P?r:i,n="function"==typeof n?n:function(){},o=["<style>",e,"</style>"].join("");return a.innerHTML+=o,i.appendChild(r),P||(i.style.background="",i.style.overflow="hidden",t=H.style.overflow,H.style.overflow="hidden",H.appendChild(i)),o=n(a,e),u.remove(a),P||(H.style.overflow=t),o}function ne(e,n){var t;return d.getComputedStyle?t=i.defaultView.getComputedStyle(e,null).getPropertyValue(n):e.currentStyle&&(t=e.currentStyle[n]),t}c.writeOnCanvas=K,c.compareCanvases=Q,c.detectFont=function(e,n,t){return n=K(t=t||"辭Q",n=n||"sans-serif"),!Q(e=K(t,e),n)},c.support=(J="Webkit Moz ms".split(" "),G=u.create("h-test"),{columnwidth:X("columnWidth"),fontface:(ee('@font-face { font-family: font; src: url("//"); }',function(e,n){e=u.qsa("style",e)[0],e=e.sheet||e.styleSheet,e=e?e.cssRules&&e.cssRules[0]?e.cssRules[0].cssText:e.cssText||"":"";$=/src/i.test(e)&&0===e.indexOf(n.split(" ")[0])}),$),ruby:(e=u.create("ruby"),n=u.create("rt"),t=u.create("rp"),e.appendChild(t),e.appendChild(n),H.appendChild(e),t="none"===ne(t,"display")||"ruby"===ne(e,"display")&&"ruby-text"===ne(n,"display"),H.removeChild(e),n=e=null,t),"ruby-display":((e=u.create("div")).innerHTML='<h-test-a style="display: ruby;"></h-test-a><h-test-b style="display: ruby-text-container;"></h-test-b>',"ruby"===e.querySelector("h-test-a").style.display&&"ruby-text-container"===e.querySelector("h-test-b").style.display),"ruby-interchar":(n="inter-character",(t=u.create("div")).innerHTML='<h-test style="-moz-ruby-position:'+n+";-ms-ruby-position:"+n+";-webkit-ruby-position:"+n+";ruby-position:"+n+';"></h-test>',(t=t.querySelector("h-test").style).rubyPosition===n||t.WebkitRubyPosition===n||t.MozRubyPosition===n||t.msRubyPosition===n),textemphasis:X("textEmphasis"),unicoderange:(ee('@font-face{font-family:test-for-unicode-range;src:local(Arial),local("Droid Sans")}@font-face{font-family:test-for-unicode-range;src:local("Times New Roman"),local(Times),local("Droid Serif");unicode-range:U+270C}',function(){Z=!c.detectFont("test-for-unicode-range",'Arial, "Droid Sans"',"Q")}),Z),writingmode:X("writingMode")}),c.initCond=function(e){var n,t,e=e||H,i="";for(t in c.support)n=(c.support[t]?"":"no-")+t,e.classList.add(n),i+=n+" ";return i};var te=c.support["ruby-interchar"];function ie(e){var r,n=u.create("!"),a=e.classList;return n.appendChild(u.clone(e)),u.tag("rt",n.firstChild).forEach(function(e){for(var n,t=u.create("!"),i=[];(n=(n||e).previousSibling)&&!n.nodeName.match(/((?:h\-)?r[ubt])/i)&&(t.insertBefore(u.clone(n),t.firstChild),i.push(n),!n.nodeName.match(/((?:h\-)?r[ubt])/i)););r=(a.contains("zhuyin")?de:se)(t,e);try{e.parentNode.replaceChild(r,e),i.map(u.remove)}catch(e){}}),oe(n)}function re(e){var n=u.create("!");return n.appendChild(u.clone(e)),u.tag("rt",n.firstChild).forEach(function(e){for(var n,t,i=u.create("!"),r=[];(n=(n||e).previousSibling)&&!n.nodeName.match(/((?:h\-)?r[ubt])/i)&&(i.insertBefore(u.clone(n),i.firstChild),r.push(n),!n.nodeName.match(/((?:h\-)?r[ubt])/i)););(t=u.create("rt")).innerHTML=ue(e),e.parentNode.replaceChild(t,e)}),n.firstChild}function ae(e){var n,t,c,s,i=u.create("!"),d=e.classList;return i.appendChild(u.clone(e)),n=i.firstChild,t=c=u.tag("rb",n),s=t.length,(e=n.querySelector("rtc.zhuyin"))&&(c=u.tag("rt",e).map(function(e,n){if(t[n]){e=de(t[n],e);try{t[n].parentNode.replaceChild(e,t[n])}catch(e){}return e}}),u.remove(e),n.setAttribute("rightangle","true")),u.qsa("rtc:not(.zhuyin)",n).forEach(function(e,o){c=u.tag("rt",e).map(function(e,n){var t,i=Number(e.getAttribute("rbspan")||1),r=0,a=[];s<i&&(i=s);do{try{t=c.shift(),a.push(t)}catch(e){}}while(void 0!==t&&(r+=Number(t.getAttribute("span")||1))<i);if(i<r){if(1<a.length)return void console.error("An impossible `rbspan` value detected.",ruby);a=u.tag("rb",a[0]),c=a.slice(i).concat(c),a=a.slice(0,i),r=i}e=se(a,e,{class:d,span:r,order:o});try{a[0].parentNode.replaceChild(e,a.shift()),a.map(u.remove)}catch(e){}return e}),1===o&&n.setAttribute("doubleline","true"),u.remove(e)}),oe(i)}function oe(e){var e=e.firstChild,n=u.create("h-ruby");return n.innerHTML=e.innerHTML,u.setAttr(n,e.attributes),n.normalize(),n}function ce(e){if(!e instanceof Element)return e;var n=e.classList;return n.contains("pinyin")?n.add("romanization"):n.contains("romanization")?n.add("annotation"):n.contains("mps")?n.add("zhuyin"):n.contains("rightangle")&&n.add("complex"),e}function se(e,n,t){var i=u.create("h-ru"),n=u.clone(n);return(t=t||{}).annotation="true",Array.isArray(e)?i.innerHTML=e.map(function(e){return void 0===e?"":e.outerHTML}).join("")+n.outerHTML:(i.appendChild(u.clone(e)),i.appendChild(n)),u.setAttr(i,t),i}function de(e,n){var e=u.clone(e),t=u.create("h-ru");return t.setAttribute("zhuyin",!0),t.appendChild(e),t.innerHTML+=ue(n),t}function ue(e){var e="string"==typeof e?e:e.textContent,n=e.replace(o.zhuyin.diao,""),t=n?n.length:0,e=e.replace(n,"").replace(/[\u02C5]/g,"ˇ").replace(/[\u030D]/g,"͘");return 0===t?"":'<h-zhuyin length="'+t+'" diao="'+e+'"><h-yin>'+n+"</h-yin><h-diao>"+e+"</h-diao></h-zhuyin>"}u.extend(c,{renderRuby:function(e,n){n=n||"ruby",n=u.qsa(n,e);u.qsa("rtc",e).concat(n).map(ce),n.forEach(function(e){var n,t=e.classList;t.contains("complex")?n=ae(e):t.contains("zhuyin")&&(n=(te?re:ie)(e)),n&&e.parentNode.replaceChild(n,e)})},simplifyRubyClass:ce,getZhuyinHTML:ue,renderComplexRuby:ae,renderSimpleRuby:ie,renderInterCharRuby:re}),u.extend(c,{renderElem:function(e){this.renderRuby(e),this.renderDecoLine(e),this.renderDecoLine(e,"s, del"),this.renderEm(e)},renderDecoLine:function(e,n){var t=u.qsa(n||"u, ins",e),i=t.length;e:for(;i--;){var r=t[i],a=null;do{if(!(a=(a||r).previousSibling))continue e}while(t[i-1]===a&&r.classList.add("adjacent"),u.isIgnorable(a))}},renderEm:function(e,n){var t=n?"qsa":"tag",n=n||"em";u[t](n,e).forEach(function(e){e=a(e);c.support.textemphasis?e.avoid("rt, h-char").charify({biaodian:!0,punct:!0}):e.avoid("rt, h-char, h-char-group").jinzify().groupify({western:!0}).charify({hanzi:!0,biaodian:!0,punct:!0,latin:!0,ellinika:!0,kirillica:!0})})}}),a.normalize=c,a.localize=c,a.support=c.support,a.detectFont=c.detectFont,a.fn.initCond=function(){return this.condition.classList.add("han-js-rendered"),a.normalize.initCond(this.condition),this},["Elem","DecoLine","Em","Ruby"].forEach(function(e){var n="render"+e;a.fn[n]=function(e){return a.normalize[n](this.context,e),this}}),u.extend(a.support,{heiti:!0,songti:a.detectFont('"Han Songti"'),"songti-gb":a.detectFont('"Han Songti GB"'),kaiti:a.detectFont('"Han Kaiti"'),fangsong:a.detectFont('"Han Fangsong"')}),a.correctBiaodian=function(e){e=e||i,e=a.find(e);return e.avoid("h-char").replace(/([‘“])/g,function(e){e=a.createBDChar(e.text);return e.classList.add("bd-open","punct"),e}).replace(/([’”])/g,function(e){e=a.createBDChar(e.text);return e.classList.add("bd-close","bd-end","punct"),e}),a.support.unicoderange?e:e.charify({biaodian:!0})},a.correctBasicBD=a.correctBiaodian,a.correctBD=a.correctBiaodian,u.extend(a.fn,{biaodian:null,correctBiaodian:function(){return this.biaodian=a.correctBiaodian(this.context),this},revertCorrectedBiaodian:function(){try{this.biaodian.revert("all")}catch(e){}return this}}),a.fn.correctBasicBD=a.fn.correctBiaodian,a.fn.revertBasicBD=a.fn.revertCorrectedBiaodian;var le,he="<<hws>>",pe=u.create("h-hws");function fe(e,n){{if(e.isEnd&&0===e.index)return n[1]+he+n[2];if(0!==e.index)return e.text;n=e.node;var t=e.text,i,r,a=n,t=t||"";if(u.isElmt(n.nextSibling)||(r=(i=n).nextSibling,i&&r&&i.parentNode===r.parentNode))return t+he;for(;!a.nextSibling;)a=a.parentNode;return n!==a&&a.insertAdjacentHTML("afterEnd","<h-hws hidden> </h-hws>"),t}}function ge(e){return 0===e.index?u.clone(pe):""}function be(e){var n=e.node.parentNode;return 0===e.index&&(le=e.endIndexInNode-2),"h-hws"!==n.nodeName.toLowerCase()||1!==e.index&&e.indexInMatch!==le||n.classList.add("quote-inner"),e.text}function me(e){var n=e.node.parentNode;return"h-hws"===n.nodeName.toLowerCase()&&n.classList.add("quote-outer"),e.text}pe.setAttribute("hidden",""),pe.innerHTML=" ",u.extend(a,{renderHWS:function(e,n){var t=n?"textarea, code, kbd, samp, pre":"textarea",n=n?"strict":"base",e=e||i,e=a.find(e);return e.avoid(t).replace(a.TYPESET.hws[n][0],fe).replace(a.TYPESET.hws[n][1],fe).replace(new RegExp("("+he+")+","g"),ge).replace(/([\'"])\s(.+?)\s\1/g,be).replace(/\s[‘“]/g,me).replace(/[’”]\s/g,me).normalize(),e}}),u.extend(a.fn,{renderHWS:function(e){return a.renderHWS(this.context,e),this},revertHWS:function(){return u.tag("h-hws",this.context).forEach(function(e){u.remove(e)}),this.HWS=[],this}});var ye="bd-hangable",s=a.find.matches;function ve(){var e,n=u.create("div");return n.innerHTML="<span>a b</span><span style=\"font-family: 'Han Space'\">a b</span>",P.appendChild(n),e=n.firstChild.offsetWidth!==n.lastChild.offsetWidth,u.remove(n),e}a.support["han-space"]=ve(),u.extend(a,{detectSpaceFont:ve,isSpaceFontLoaded:ve(),renderHanging:function(e){e=e||i,e=a.find(e);return e.avoid("textarea, code, kbd, samp, pre").avoid("h-char.bd-hangable").replace(o.jinze.hanging,function(e){if(/^[\x20\t\r\n\f]+$/.test(e.text))return"";var n,t,i=e.node.parentNode;return(n=u.parent(i,"h-jinze"))&&((t=(n=n).nextSibling)&&s(t,"h-cs.jinze-outer")?t.classList.add("hangable-outer"):n.insertAdjacentHTML("afterend",'<h-cs hidden class="jinze-outer hangable-outer"> </h-cs>')),t=e.text.trim(),(n=a.createBDChar(t)).innerHTML="<h-inner>"+t+"</h-inner>",n.classList.add(ye),(e=u.parent(i,"h-char.biaodian"))?(e.classList.add(ye),s(i,"h-inner, h-inner *")?t:n.firstChild):n}),e}}),u.extend(a.fn,{renderHanging:function(){var e=this.condition.classList;return a.isSpaceFontLoaded=ve(),a.isSpaceFontLoaded&&e.contains("no-han-space")&&(e.remove("no-han-space"),e.add("han-space")),a.renderHanging(this.context),this},revertHanging:function(){return u.qsa("h-char.bd-hangable, h-cs.hangable-outer",this.context).forEach(function(e){e=e.classList;e.remove("bd-hangable"),e.remove("hangable-outer")}),this}});var xe,Ee,we="bd-jiya",Ce="bd-consecutive",Ne='<h-cs hidden class="jinze-outer jiya-outer"> </h-cs>',s=a.find.matches;function Te(e){return e.replace(/(biaodian|cjk|bd-jiya|bd-consecutive|bd-hangable)/gi,"").trim()}function Se(e){var n,t=e.text,e=e.node.parentNode,i=u.parent(e,"h-char.biaodian"),r=a.createBDChar(t);return r.innerHTML="<h-inner>"+t+"</h-inner>",r.classList.add(we),(n=u.parent(e,"h-jinze"))&&(s(n=n,".tou, .touwei")&&!s(n.previousSibling,"h-cs.jiya-outer")&&n.insertAdjacentHTML("beforebegin",Ne),s(n,".wei, .touwei")&&!s(n.nextSibling,"h-cs.jiya-outer")&&n.insertAdjacentHTML("afterend",Ne)),i?(i.classList.add(we),s(e,"h-inner, h-inner *")?t:r.firstChild):r}function Le(e){var n=xe,t=e.node.parentNode,t=u.parent(t,"h-char.biaodian"),i=u.parent(t,"h-jinze"),r=t.classList;return n&&t.setAttribute("prev",n),Ee&&r.contains("bd-open")&&Ee.pop().setAttribute("next","bd-open"),Ee=void 0,e.isEnd?(xe=void 0,r.add(Ce,"end-portion")):(xe=Te(t.getAttribute("class")),r.add(Ce)),i&&(Ee=function(e,n){var t,i;s(e,".tou, .touwei")&&(t=e.previousSibling,s(t,"h-cs")&&(t.className="jinze-outer jiya-outer",t.setAttribute("prev",n.prev)));s(e,".wei, .touwei")&&(i=e.nextSibling,s(i,"h-cs")&&(i.className="jinze-outer jiya-outer "+n.class,i.removeAttribute("prev")));return[t,i]}(i,{prev:n,class:Te(t.getAttribute("class"))})),e.text}a.renderJiya=function(e){e=e||i,e=a.find(e);return e.avoid("textarea, code, kbd, samp, pre, h-cs").avoid("h-char.bd-jiya").charify({avoid:!1,biaodian:Se}).endAvoid().avoid("textarea, code, kbd, samp, pre, h-cs").replace(o.group.biaodian[0],Le).replace(o.group.biaodian[1],Le),e},u.extend(a.fn,{renderJiya:function(){return a.renderJiya(this.context),this},revertJiya:function(){return u.qsa("h-char.bd-jiya, h-cs.jiya-outer",this.context).forEach(function(e){e=e.classList;e.remove("bd-jiya"),e.remove("jiya-outer")}),this}});var ze="textarea, code, kbd, samp, pre";function ke(t,i,r){return function(){var e=a.localize.writeOnCanvas(i,t),n=a.localize.writeOnCanvas(r,t);return a.localize.compareCanvases(e,n)}}function Ie(){return ke('"Romanization Sans"',"i̍","󰁩")}function Me(t){return function(e){var e=e||i,n=a.find(e).avoid(ze);return t.forEach(function(i){n.replace(new RegExp(i[0],"ig"),function(e,n){var t=u.clone(Re);return t.innerHTML="<h-inner>"+n[0]+"</h-inner>",t.setAttribute("display-as",i[1]),0===e.index?t:""})}),n}}var Re=u.create("h-char","comb-liga");return u.extend(a,{isVowelCombLigaNormal:ke('"Romanization Sans"',"a̍","󰁡"),isVowelICombLigaNormal:Ie(),isZhuyinCombLigaNormal:ke('"Zhuyin Kaiti"',"ㆴ͘","󳆴"),isCombLigaNormal:Ie()(),substVowelCombLiga:Me(a.TYPESET["display-as"]["comb-liga-vowel"]),substZhuyinCombLiga:Me(a.TYPESET["display-as"]["comb-liga-zhuyin"]),substCombLigaWithPUA:Me(a.TYPESET["display-as"]["comb-liga-pua"]),substInaccurateChar:function(e){var e=e||i,n=a.find(e);n.avoid(ze),a.TYPESET["inaccurate-char"].forEach(function(e){n.replace(new RegExp(e[0],"ig"),e[1])})}}),u.extend(a.fn,{"comb-liga-vowel":null,"comb-liga-vowel-i":null,"comb-liga-zhuyin":null,"inaccurate-char":null,substVowelCombLiga:function(){return this["comb-liga-vowel"]=a.substVowelCombLiga(this.context),this},substVowelICombLiga:function(){return this["comb-liga-vowel-i"]=a.substVowelICombLiga(this.context),this},substZhuyinCombLiga:function(){return this["comb-liga-zhuyin"]=a.substZhuyinCombLiga(this.context),this},substCombLigaWithPUA:function(){return a.isVowelCombLigaNormal()?a.isVowelICombLigaNormal()||(this["comb-liga-vowel-i"]=a.substVowelICombLiga(this.context)):this["comb-liga-vowel"]=a.substVowelCombLiga(this.context),a.isZhuyinCombLigaNormal()||(this["comb-liga-zhuyin"]=a.substZhuyinCombLiga(this.context)),this},revertVowelCombLiga:function(){try{this["comb-liga-vowel"].revert("all")}catch(e){}return this},revertVowelICombLiga:function(){try{this["comb-liga-vowel-i"].revert("all")}catch(e){}return this},revertZhuyinCombLiga:function(){try{this["comb-liga-zhuyin"].revert("all")}catch(e){}return this},revertCombLigaWithPUA:function(){try{this["comb-liga-vowel"].revert("all"),this["comb-liga-vowel-i"].revert("all"),this["comb-liga-zhuyin"].revert("all")}catch(e){}return this},substInaccurateChar:function(){return this["inaccurate-char"]=a.substInaccurateChar(this.context),this},revertInaccurateChar:function(){try{this["inaccurate-char"].revert("all")}catch(e){}return this}}),d.addEventListener("DOMContentLoaded",function(){var e;H.classList.contains("han-init")?a.init():(e=i.querySelector(".han-init-context"))&&(a.init=a(e).render())}),void 0!==l&&!1!==l||(d.Han=a),a});